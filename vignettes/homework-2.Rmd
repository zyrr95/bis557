---
title: "The ridge regression"
author: "Yuren Zhang"
date: "`r Sys.Date()`"
output:
  html_document:
    self_contained: yes
    toc: true
---
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{The ridge regression vignette}
-->

#Loading
```{r}
library(bis557)
data(ridge_train)
data(ridge_test)
```

#Rideg Regression Predict Function

```{r}
predict.ridge_reg = function(object,...) {
  newdata = list(...)[[1]]
  m = model.matrix(object$form, newdata)
  m %*% object$coefficients
}
```

#Calculating MSE

```{r}
lambdas = seq(0.1, 100, by=0.1)
MSEs = rep(NA, length(lambdas))
for (i in 1:length(lambdas)){
  fit = ridge_reg(y ~., lambda_seq[i], ridge_train)
  error = ridge_test$y - predict(fit, ridge_test)
  MSEs[i] = mean(error^2)
}
```

#Plotting MSEs
```{r}
plot(log(lambdas), MSEs, xlab = "Value of log(Lambda)", ylab = "Mean Squared Error", col="Red")
```

#Finding the Lambda With Minimum MSE
```{r}
lambdas[which.min(MSEs)]
```



